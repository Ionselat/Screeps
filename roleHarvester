module.exports = {
    run (creep, source, spawn, energyLevel, status)
    {
        var targets = creep.room.find(FIND_STRUCTURES , {
                    filter: (structure) => {
                        return (structure.structureType == STRUCTURE_EXTENSION || structure.structureType == STRUCTURE_SPAWN) &&
                            structure.energy < structure.energyCapacity;
                    }
            });
            

        if(status == 'gathering' && targets.length > 0 && creep.transfer(targets[0], RESOURCE_ENERGY) == ERR_NOT_IN_RANGE)
            creep.moveTo(targets[0]);

        if(energyLevel == 0)
            creep.memory.status = 'gathering';

        if(energyLevel == creep.carryCapacity)
            creep.memory.status = 'transferring';

        if(status == 'gathering' && creep.harvest(source[0]) == ERR_NOT_IN_RANGE)
        {
            creep.moveTo(source[0]);
            creep.say('gathering');
        }

        if(status == 'transferring' && creep.transfer(spawn, RESOURCE_ENERGY) == ERR_NOT_IN_RANGE)
            creep.moveTo(spawn);
    }
};
